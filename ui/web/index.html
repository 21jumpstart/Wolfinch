

<!-- ######## This is a comment, visible only in the source editor  ######## -->
<!DOCTYPE script PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<!-- 		<script src="https://code.jquery.com/jquery-3.3.1.min.js"
			integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
			crossorigin="anonymous"></script> -->
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
	integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
	crossorigin="anonymous"></script>
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
	integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
	crossorigin="anonymous"></script>

<link rel="stylesheet" type="text/css"
	href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">

<script type="text/javascript" charset="utf8"
	src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>
<!--  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.bootstrap.js"></script>
 -->


<script type="text/javascript">
	/* 
	 $(document).ready( function () {
	 $('#statsTable').DataTable();
	 } );
	 */
	/* 			var dataSet = [
	 {"id":"50b68478-76e0-11e9-8be1-8c8590ab863e", "product_id":"BTC-USD",
	 "side":"buy", "order_type":"market", "status_type":"done", "status_reason":"filled",
	 "request_size":0.009659, "filled_size":0.009659, "remaining_size":0.000000, "price":5176.580000, 
	 "funds":50.000000, "fees":0.000000, "create_time":"2018-01-10T09:49:02.639681Z", "update_time":"None"}]
	 */

	/* 	 {
	 "exchange_name": "CBPRO", "product_id": "BTC-USD","name": "BTC/USD",
	 "num_buy_req": 1222, "num_buy_req_reject": 678,
	 "num_sell_req": 486, "num_sell_req_reject": 0,
	 "num_buy_order": 544, "num_buy_order_success": 544, "num_buy_order_failed": 0,                   
	 "num_sell_order": 486, "num_sell_order_success": 486, "num_sell_order_failed": 0,
	 "fund":
	 {
	 "initial_value":2000.000000,"current_value":3144.391100,"current_hold_value":0.000146, "total_traded_value":25660.000000, "fee_accrued": 0.000000,
	 "current_realized_profit":3002.599900,"current_unrealized_profit":0.000000, "total_profit":0.000000,
	 "current_avg_buy_price":5430.439000,"latest_buy_price":44172.710000,
	 "fund_liquidity_percent":90, "max_per_buy_fund_value":50
	 },
	 "asset":{
	 "initial_size":10.000000, "current_size":9.796999, "hold_size": 0.100000, "current_hold_size":0.000000, 
	 "max_per_trade_size":0.010000, "latest_traded_size":0.001132, "total_traded_size":8.908994
	 }
	 } */

	 function loadTradingStats() {
			$.ajax({
				type : 'GET',
				url : '/api/market_stats',
				data : {
					get_param : 'value'
				},
				dataType : 'json',
				success : function(data) {
					console.log(data.exchange_name)
					$("#exch").text(data.exchange_name)
					$("#mkt").text(data.product_id)
					$("#nbuy").text(data.num_buy_req)
					$("#nbuy_rej").text(data.num_buy_req_reject)
					$("#nsell").text(data.num_sell_req)
					$("#nsell_rej").text(data.num_sell_req_reject)
					$("#nbuy_odr").text(data.num_buy_order)
					$("#nbuy_odr_s").text(data.num_buy_order_success)
					$("#nbuy_odr_f").text(data.num_buy_order_failed)
					$("#nsell_odr").text(data.num_sell_order)
					$("#nsell_odr_s").text(data.num_sell_order_success)
					$("#nsell_odr_f").text(data.num_sell_order_failed)

					//#Fund
					$("#fund_init").text(data.fund.initial_value)
					$("#fund_curr").text(data.fund.current_value)
					$("#curr_hold").text(data.fund.current_hold_value)
					$("#fund_profit").text(data.fund.current_realized_profit)
					$("#fund_traded").text(data.fund.total_traded_value)
					$("#fund_avg_price").text(data.fund.current_avg_buy_price)
					$("#fund_last_price").text(data.fund.latest_buy_price)

					//#Assets
					$("#asset_init").text(data.asset.initial_size)
					$("#asset_curr").text(data.asset.current_size)
					$("#asset_traded").text(data.asset.total_traded_size)
					$("#asset_last_traded").text(data.asset.latest_traded_size)
					$("#asset_max_per_trade").text(data.asset.max_per_trade_size)
					/* 	            $.each(data, function(index, element) {
					 $('body').append($('<div>', {
					 text: element.name
					 }));
					 }); */
				}
			});
	 }
	var table;
	$(document).ready(function() {

		loadTradingStats();
		setInterval(loadTradingStats, 30000);
		

		table = $('#statsTable').DataTable({
			//data : dataSet,
			//ajax: '/api/data',
			"processing" : true,
			pageLength : 25,
			ajax : {
				url : "/api/order_data?abcd=1",
				dataSrc : ''
			},
			columns : [ {
				title : "side",
				data : "side"
			}, {
				title : "type",
				data : "order_type"
			}, {
				title : "request size",
				data : "request_size"
			}, {
				title : "filled size",
				data : "filled_size"
			}, {
				title : "remaining size",
				data : "remaining_size"
			}, {
				title : "price",
				data : "price"
			}, {
				title : "funds ",
				data : "funds"
			}, {
				title : "time",
				data : "create_time"
			}, {
				title : "status",
				data : "status_type"
			}

			]
		});

		setInterval(function() {
			table.ajax.reload(null, false); // user paging is not reset on reload
		}, 30000);
	});
</script>
<p></p>
<div>
	<p></p>
</div>
<div>
	<p></p>
</div>
<div>
	<h1 style="color: #4485b8; text-align: center;">
		<span
			style="background-color: #4485b8; color: #ffffff; padding: 0 5px;">
			Stats</span>
	</h1>
</div>
<div>
	<table border="1" style="border-collapse: collapse; width: 100%;"
		class="display">
		<tbody>
			<tr style="height: 60px;">
				<td style="width: 45%; height: 60px;">
					<table style="margin: false; height: 60px;" border="1" height="49">
						<tbody>
							<tr style="background-color: rgba(0, 0, 0, 0.1);">
								<td align="center" style="border: 0;" colspan="9">
									<!-- style="width: 101.272%;"  > --> <b>Trades</b>
								</td>
							</tr>
							<tr style="margin: 0; background-color: rgba(0, 0, 0, 0.1);">
								<td align="center" colspan="3" style="border: 0;"></td>

								<td align="center" style="border: 0;">Num Reqs</td>
								<td align="center" style="border: 0;">Rejects</td>
								<td align="center" style="border: 0;">Orders</td>
								<td align="center" style="border: 0;">Success</td>
								<td align="center" style="border: 0;">Failed</td>
							</tr>
							<tr style="border-top: 0px solid #555;">
								<td
									style="border: 0px solid #555555; width: 74px; height: 24px;">Exchange</td>
								<td id="exch" style="border: 0; width: 92px; height: 24px;">exch_name</td>

								<td style="border: 0; width: 50px;">&nbsp;Buy</td>
								<td align="center" id="nbuy" style="border: 0; width: 92px;">&nbsp;num_buys</td>
								<td align="center" id="nbuy_rej" style="border: 0; width: 92px;">&nbsp;num_sells</td>
								<td align="center" id="nbuy_odr" style="border: 0; width: 87px;">&nbsp;num_buys</td>
								<td align="center" id="nbuy_odr_s"
									style="border: 0; width: 70px;">&nbsp;success</td>
								<td align="center" id="nbuy_odr_f"
									style="border: 0; width: 158px;">fail</td>

							</tr>
							<tr style="background-color: rgba(0, 0, 0, 0.1);">
								<td style="border: 0; width: 74px; height: 23px;">Market</td>
								<td id="mkt" style="border: 0; width: 92px; height: 23px;">mkt_name</td>

								<td style="border: 0; width: 50px;">&nbsp;Sell</td>
								<td align="center" id="nsell" style="border: 0; width: 92px;">&nbsp;num_sells</td>
								<td align="center" id="nsell_rej"
									style="border: 0; width: 92px;">&nbsp;Reject</td>
								<td align="center" id="nsell_odr"
									style="border: 0; width: 87px;">&nbsp;num_sell</td>
								<td align="center" id="nsell_odr_s"
									style="border: 0; width: 70px;">&nbsp;success</td>
								<td align="center" id="nsell_odr_f"
									style="border: 0; width: 158px;">fail</td>
							</tr>
						</tbody>
					</table>
				</td>
				<td style="width: 45%;">
					<!-- style="width: 1.65893%; height: 60px;"> -->
					<table border="0" style="border-collapse: collapse;"
						class="display">
						<tbody>
							<tr style="background-color: rgba(0, 0, 0, 0.1);">
								<td align="center" colspan="9">
									<!-- style="width: 101.272%;"  > --> <b>Funds</b>
								</td>
							</tr>
							<tr>
								<td style="width: 10%;">Inital</td>
								<td style="width: 10%;">Current</td>
								<td style="width: 10%;">Curr. hold</td>
								<td style="width: 10%;">Total Traded</td>
								<td style="width: 10%;">Rel. Profit</td>
								<td style="width: 10%;">Avg. Price</td>
								<td style="width: 10%;">Last Price</td>
								<td style="width: 10%;"></td>
								<td style="width: 10%;"></td>
							</tr>
							<tr style="background-color: rgba(0, 0, 0, 0.1);" border="1px">
								<td style="width: 10%;" id="fund_init">0</td>
								<td style="width: 10%;" id="fund_curr">0</td>
								<td style="width: 10%;" id="curr_hold">0</td>
								<td style="width: 10%;" id="fund_profit">0</td>
								<td style="width: 10%;" id="fund_traded">0</td>
								<td style="width: 10%;" id="fund_avg_price"></td>
								<td style="width: 10%;" id="fund_last_price">0</td>
								<td style="width: 10%;"></td>
								<td style="width: 10%;"></td>
							</tr>
						</tbody>
					</table>
				</td>
				<td style="width: 33%;">
					<!--  style="width: 1.65893%; height: 60px;"> -->
					<table border="0" style="border-collapse: collapse; width: 100%;"
						class="display">
						<tbody>
							<tr style="background-color: rgba(0, 0, 0, 0.1);">
								<td style="width: 100;" colspan="5" align="center"><b>Assets</b></td>
							</tr>
							<tr>
								<td style="width: 10%;">Inital</td>
								<td style="width: 10%;">Current</td>
								<td style="width: 10%;">Total Traded</td>
								<td style="width: 10%;">Last Traded</td>
								<td style="width: 10%;">Max per trade</td>
							</tr>
							<tr style="background-color: rgba(0, 0, 0, 0.1);">
								<td style="width: 10%;" id="asset_init">0</td>
								<td style="width: 10%;" id="asset_curr">0</td>
								<td style="width: 10%;" id="asset_traded">0</td>
								<td style="width: 10%;" id="asset_last_traded">0</td>
								<td style="width: 10%;" id="asset_max_per_trade">0</td>
							</tr>
						</tbody>
					</table>
				</td>
			</tr>
			<tr style="width: 75%; height: 23px;" align="center">
				<td style="width: 75%; height: 23px; border-collapse: collapse;"
					colspan="3">
					<table id="statsTable" class="display compact"
						style="vertical-align: top; height:100%; width:85%">
						<thead>
							<tr>
								<th style="width: 50px;">0</th>
								<th style="width: 75px;">1</th>
								<th style="width: 75px;">2</th>
								<th style="width: 75px;">3</th>
								<th style="width: 50px;">4</th>
								<th style="width: 75px;">5</th>
								<th style="width: 75px;">6</th>
								<th style="width: 70px;">7</th>
								<th style="width: 75px;">8</th>
								<!-- 								<th style="width: 179px;">9</th>								
 -->
							</tr>
						</thead>
						<tbody></tbody>
					</table>
				</td>
			</tr>
		</tbody>
	</table>

</div>
<div></div>
<div>
	<p></p>
</div>
<div>
	<hr />
</div>
<div>
	<div style="align: bottom">
		<p>
			<em>&copy; 2017-2019 OldMonk, Joshith Rayaroth Koderi</em>
		</p>
	</div>
</div>
</html>